<!doctype html>
<html>

<head>
    <title>Line Chart</title>
    <script src="Charts/Chart.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.24.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-moment@0.1.1"></script>
    <script src="js/utils.js"></script>
	<script src="js/class.js"></script>
	<script>
		'use strict';

window.chartColors = {
	red: 'rgb(255, 99, 132)',
	orange: 'rgb(255, 159, 64)',
	yellow: 'rgb(255, 205, 86)',
	green: 'rgb(75, 192, 192)',
	blue: 'rgb(54, 162, 235)',
	purple: 'rgb(153, 102, 255)',
	grey: 'rgb(201, 203, 207)'
};

(function (global) {
	var MONTHS = [
		'January',
		'February',
		'March',
		'April',
		'May',
		'June',
		'July',
		'August',
		'September',
		'October',
		'November',
		'December'
	];

	var COLORS = [
		'#4dc9f6',
		'#f67019',
		'#f53794',
		'#537bc4',
		'#acc236',
		'#166a8f',
		'#00a950',
		'#58595b',
		'#8549ba'
	];

	var Samples = global.Samples || (global.Samples = {});
	var Color = Chart.helpers.color;

	function applyDefaultNumbers(config) {
		var cfg = config || {};
		cfg.min = cfg.min || 0;
		cfg.max = cfg.max || 1;
		cfg.from = cfg.from || [];
		cfg.count = cfg.count || 8;
		cfg.decimals = cfg.decimals || 8;
		cfg.continuity = cfg.continuity || 1;

		return cfg;
	}

	Samples.utils = {
		// Adapted from http://indiegamr.com/generate-repeatable-random-numbers-in-js/
		srand: function (seed) {
			this._seed = seed;
		},

		rand: function (min, max) {
			var seed = this._seed;
			min = min === undefined ? 0 : min;
			max = max === undefined ? 1 : max;
			this._seed = (seed * 9301 + 49297) % 233280;
			return min + (this._seed / 233280) * (max - min);
		},

		numbers: function (config) {
			var cfg = applyDefaultNumbers(config);
			var dfactor = Math.pow(10, cfg.decimals) || 0;
			var data = [];
			var i, value;

			for (i = 0; i < cfg.count; ++i) {
				value = (cfg.from[i] || 0) + this.rand(cfg.min, cfg.max);
				if (this.rand() <= cfg.continuity) {
					data.push(Math.round(dfactor * value) / dfactor);
				} else {
					data.push(null);
				}
			}

			return data;
		},

		labels: function (config) {
			var cfg = config || {};
			var min = cfg.min || 0;
			var max = cfg.max || 100;
			var count = cfg.count || 8;
			var step = (max - min) / count;
			var decimals = cfg.decimals || 8;
			var dfactor = Math.pow(10, decimals) || 0;
			var prefix = cfg.prefix || '';
			var values = [];
			var i;

			for (i = min; i < max; i += step) {
				values.push(prefix + Math.round(dfactor * i) / dfactor);
			}

			return values;
		},

		months: function (config) {
			var cfg = config || {};
			var count = cfg.count || 12;
			var section = cfg.section;
			var values = [];
			var i, value;

			for (i = 0; i < count; ++i) {
				value = MONTHS[Math.ceil(i) % 12];
				values.push(value.substring(0, section));
			}

			return values;
		},

		color: function (index) {
			return COLORS[index % COLORS.length];
		},

		transparentize: function (color, opacity) {
			var alpha = opacity === undefined ? 0.5 : 1 - opacity;
			return Color(color).alpha(alpha).rgbString();
		}
	};

	// DEPRECATED
	window.randomScalingFactor = function () {
		return Math.round(Samples.utils.rand(-100, 100));
	};

	// INITIALIZATION

	Samples.utils.srand(Date.now());

	// Google Analytics
	/* eslint-disable */
	if (document.location.hostname.match(/^(www\.)?chartjs\.org$/)) {
		(function (i, s, o, g, r, a, m) {
			i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
				(i[r].q = i[r].q || []).push(arguments)
			}, i[r].l = 1 * new Date(); a = s.createElement(o),
				m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
		})(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
		ga('create', 'UA-28909194-3', 'auto');
		ga('send', 'pageview');
	}
	/* eslint-enable */

}(this));


	</script>
    <style>
        canvas {
            -moz-user-select: none;
            -webkit-user-select: none;
            -ms-user-select: none;
			width:85%;
        }
    </style>
</head>

<body>
	<div id="container">
		<div id="inputs">
			<input name="objectName" type="text" placeholder="objectName" />
			<input name="mass1" type="text" placeholder="mass1 kg" />
			<input name="mass2" type="text" placeholder="mass2 kg" />
			<input name="radius" type="text" placeholder="radius meters" />
			<input type="button" value="Make Chart" />
		</div>

	</div>
    <br>
    <br>

	<script>
		var timeFormat = 'MM/DD/YYYY HH:mm';
		var e = 5.97219 * 10 ** 24;
		var me = 70;
		//var G = 6.673 * 10 ** -11;

		const params = new URLSearchParams(location.search);

		function newDate(days) {
			return moment().add(days, 'd').toDate();
		}

		function newDateString(days) {
			return moment().add(days, 'd').format(timeFormat);
		}

		function getDistance(d) {
			return 6371000 * d;
		}

		var color = Chart.helpers.color;

		var radius = +params.get('radius');
		var step = +params.get('step');

		var orad = +params.get('oradius');
		var ostep = +params.get('ostep');

		var mass2 = +params.get('m2');



		/**
		 * Returns an array of distances from center at equal intervals
		 * The length of the array is equal to range/step
		 * @param {int} range in meters
		 * @param {int} step in meter
		 */
		function getDistances(range, step) {

			var i, ar = [];
			for (i = step; i < range; i += step) {
				ar.push(i);
			}
			return ar;
		}

		var interval = getDistances(radius, step);

		var intervals = getDistances(orad, ostep);

		var earthG = gravity(interval, e, mass2);

		//intervals = intervals.push(intervals[0] * .1);

		var objectG = gravity(intervals, getSphericalMass(.1), mass2);

		var earth = {
			type: 'line',
			data: {
				labels: interval,
				datasets: [{
					label: 'Earth gravity m/s at distance',
					backgroundColor: color(window.chartColors.red).alpha(0.5).rgbString(),
					borderColor: window.chartColors.red,
					fill: true,
					data: earthG,
				}

				]
			}
		};

		var object = {
			type: 'line',
			data: {
				labels: intervals,
				datasets: [{
					label: 'Object gravity m/s at distance',
					backgroundColor: color(window.chartColors.green).alpha(0.5).rgbString(),
					borderColor: window.chartColors.green,
					fill: true,
					data: objectG,
				}

				]
			}
		};

		function gravity(steps, m1, m2) {
			var arr = [];
			for (s of steps) {
				var f = G * (m1 * m2) / (s ** 2);
				arr.push(f / 9.801);
			}


			return arr;
		}


		/**
		 * Returns the mass of an earth density (5513kg/mï¿½) object
		 * @param {number} diameter in meters
		 * cm = .01, mm = .001
		 */
		function getCubicMass(diameter, bool) {
			return 5513 * diameter ** 3;
		}

		function getSphericalMass(radius) {
			return 5513 * (4 / 3 * Math.PI * radius ** 3);
		}


		var colorNames = Object.keys(window.chartColors);

	</script>
	<script>
        var makeChart = document.querySelector("input[type=button]");


        makeChart.addEventListener("click", function (e) {
            //get all inputs in one doc query...
            let inputs = document.querySelectorAll("input[type=text]");
            let objectName = inputs[0].value;
            let mass1 = inputs[1].value;
            let mass2 = inputs[2].value;
            let radius = inputs[3].value;


            window[objectName] = document.createElement("canvas");

            document.querySelector("#container").insertAdjacentElement("beforeend", window[objectName]);

            let ctx = window[objectName].getContext('2d');

            console.log(objectName);


            //var ctx = document.getElementById('earth').getContext('2d');
            //window.myLine = new Chart(ctx, earth);
            //var obj_ctx = document.getElementById('object').getContext('2d');
            //window.myLine = new Chart(obj_ctx, object);


        });
	</script>

</body>

</html>